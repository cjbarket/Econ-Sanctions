---
title: "Sanctions"
format: html
editor: visual
---

```{r message = FALSE}
#|: loading-necessary-pkgs

library(writexl) #for writing Excel files
library(tempdisagg) #trying to use for freq conv
library(tsbox) #also trying to use for freq conv
library(wbstats) #for country GDPs from World Bank
library(tidyverse) 
library(tidymodels)
library(reticulate) #for running python stuff
# library(httr)
# library(jsonlite)
# library(rjson)
```

```{r}
#|: importing-python-pkgs

os <- import("os")
requests <- import("requests")
json <- import("json")
pandas <- import("pandas")
comtrade <- import("comtradeapicall")
py_install("pandas")
py_install("requests")
# py_install("comtradeapicall")
```

```{r}
#|: bringing-in-python-scripts

source_python("comtrade.py")
source_python("imf.py")
```

```{r}
#|: for-finding-stuff-in-wbstats

wb_search("Export") |> view()
wb_search("GDP") |> view()
str(wb_cachelist, max.level = 1)
wb_indicators <- wb_cachelist$indicators |> view()
```

```{r}
#|: using-wbstats-pkg-to-get-GDPs-and-total-exports
# in USD + years 

gdp <- c("GDP" = "NY.GDP.MKTP.CD")
exports <- c("total_exports" ="BX.GSR.GNFS.CD")
indicators <- c(gdp, exports)

total <- wb_data(
  indicators, 
  country = "all",
  mrv = 5
)

view(total)
#write_xlsx(
# total, 
# "/Users/pauldilly/Documents/Internships/Econ Research/Econ-Sanctions/data/wb_both.xlsx")
#write_csv(total, "data/wb_both.csv")
```

```{r}
#|: load-imf.py-test

test <- read_csv("data/test.csv")
view(test)
test <- test |>
  mutate(
    col
  )
typeof(test$W00)
typeof(test$B0)
test <- pivot_longer(
  test, 
  !...1,
  names_to = "country",
  values_to = "value"
)
view(test)
```

```{r}
#|: freq-conversion

# tsbox attempt
ts_frequency(gdp_per_country, to = "month", aggregate = "mean", na.rm = FALSE) |> view()

# tempdisagg attempt
data(swisspharma)
plot(sales.a)
sales.a |> view()
m1 <- td(sales.a ~ 1, to = "quarterly", method = "denton-cholette")
predict(m1) |> view()
```
